<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Demo products page for testing GTM ecommerce tracking events">
    <title>Products - GTM Learning Project</title>

    <!-- CSS -->
    <link rel="stylesheet" href="css/style.css">

    <!--
        ============================================================================
        STEP 1: Set Default Consent State (BEFORE GTM loads)
        ============================================================================

        CRITICAL: This MUST come BEFORE the GTM script!

        Why? Because GTM needs to know the consent state from the moment it loads.
        By setting everything to 'denied' first, we ensure that no tracking cookies
        are set or personal data collected until the user explicitly consents.

        This is the "default denied" approach required by GDPR and recommended
        by Google for Consent Mode v2.

        What each consent type means:
        - ad_storage: Enables storage (like cookies) for advertising purposes
        - ad_user_data: Enables sending user data to Google for advertising
        - ad_personalization: Enables personalized advertising (e.g., remarketing)
        - analytics_storage: Enables storage for analytics (like cookies)
        - functionality_storage: Enables storage for site functionality
        - personalization_storage: Enables storage for personalization (e.g., video recommendations)
        - security_storage: Usually always granted for security features like fraud prevention

        wait_for_update: Tells GTM to wait up to 500ms for a consent update
        before making decisions. This gives our consent banner time to load.
    -->
    <script>
        // Initialize the dataLayer (GTM's communication channel)
        window.dataLayer = window.dataLayer || [];

        // Define gtag function - this is how we communicate consent to Google
        function gtag() { dataLayer.push(arguments); }

        // Set default consent to DENIED for all types
        // This is the privacy-first approach - no tracking without explicit consent
        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'analytics_storage': 'denied',
            'functionality_storage': 'denied',
            'personalization_storage': 'denied',
            'security_storage': 'granted', // Security features are usually always allowed
            'wait_for_update': 500 // Wait 500ms for consent banner to update consent
        });

        console.log('Consent defaults set to DENIED - GTM will respect privacy until user consents');
    </script>

    <!--
        ============================================================================
        STEP 2: Google Tag Manager Container
        ============================================================================

        NOW we load GTM. Since we've already set the default consent state above,
        GTM knows to operate in "denied" mode until the user grants permission.

        Container ID: GTM-WNS3P8L9
    -->
    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-WNS3P8L9');</script>
    <!-- End Google Tag Manager -->
</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WNS3P8L9" height="0" width="0"
            style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <!-- Header & Navigation -->
    <header>
        <div class="header-container">
            <a href="index.html" class="logo">GTM Prckanje</a>
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="products.html">Products</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    <li><a href="privacy.html">Privacy</a></li>
                    <!-- Basket link with SVG cart icon and item counter badge -->
                    <li>
                        <a href="basket.html" class="basket-link">
                            <svg class="cart-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M7 18c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM7.16 14.26l.04-.12.94-1.7h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49A1 1 0 0020.04 4H5.21l-.94-2H1v2h2l3.6 7.59-1.35 2.44C4.52 15.37 5.48 17 7 17h12v-2H7.42c-.13 0-.22-.09-.22-.2l-.04-.04z"/>
                            </svg>
                            Basket
                            <span id="basket-count" class="basket-badge" style="display:none;">0</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <div class="container-wide">
            <h1>Demo Products</h1>
            <p>
                This page demonstrates GA4 ecommerce tracking. Each "Add to Basket" button
                pushes an <code>add_to_cart</code> event to the dataLayer that GTM can capture
                and forward to Google Analytics 4.
            </p>

            <!--
                ============================================================================
                PRODUCT GRID
                ============================================================================

                Each product card has data-* attributes that store product information.
                When the user clicks "Add to Basket", JavaScript reads these attributes
                and passes them to the basket module, which then pushes the GA4 ecommerce
                event to the dataLayer.

                WHY data-* attributes?
                - They keep product data in the HTML where it belongs
                - JavaScript can easily read them with getAttribute()
                - GTM can also read them using "Click Element" variables if needed
                - Clean separation of concerns (HTML = data, JS = behavior)
            -->
            <div class="product-grid">

                <!-- Product 1 -->
                <div class="product-card"
                    data-item-id="SKU-001"
                    data-item-name="GTM Essentials Course"
                    data-item-price="49.99">
                    <div class="product-image-placeholder">GTM</div>
                    <h3>GTM Essentials Course</h3>
                    <p class="product-description">Learn the fundamentals of Google Tag Manager from scratch. Covers containers, tags, triggers, and variables.</p>
                    <div class="product-price">49.99 EUR</div>
                    <button class="btn add-to-basket-btn">Add to Basket</button>
                </div>

                <!-- Product 2 -->
                <div class="product-card"
                    data-item-id="SKU-002"
                    data-item-name="Advanced GA4 Tracking"
                    data-item-price="79.99">
                    <div class="product-image-placeholder">GA4</div>
                    <h3>Advanced GA4 Tracking</h3>
                    <p class="product-description">Master Google Analytics 4 event tracking, custom dimensions, and advanced reporting techniques.</p>
                    <div class="product-price">79.99 EUR</div>
                    <button class="btn add-to-basket-btn">Add to Basket</button>
                </div>

                <!-- Product 3 -->
                <div class="product-card"
                    data-item-id="SKU-003"
                    data-item-name="Consent Mode Implementation"
                    data-item-price="39.99">
                    <div class="product-image-placeholder">GDPR</div>
                    <h3>Consent Mode Implementation</h3>
                    <p class="product-description">Implement Google Consent Mode v2 for GDPR and privacy compliance on any website.</p>
                    <div class="product-price">39.99 EUR</div>
                    <button class="btn add-to-basket-btn">Add to Basket</button>
                </div>

                <!-- Product 4 -->
                <div class="product-card"
                    data-item-id="SKU-004"
                    data-item-name="E-commerce Tracking Bundle"
                    data-item-price="99.99">
                    <div class="product-image-placeholder">SHOP</div>
                    <h3>E-commerce Tracking Bundle</h3>
                    <p class="product-description">Complete guide to tracking online store events: product views, add to cart, checkout, and purchases.</p>
                    <div class="product-price">99.99 EUR</div>
                    <button class="btn add-to-basket-btn">Add to Basket</button>
                </div>

                <!-- Product 5 -->
                <div class="product-card"
                    data-item-id="SKU-005"
                    data-item-name="Custom Variables Workshop"
                    data-item-price="59.99">
                    <div class="product-image-placeholder">VAR</div>
                    <h3>Custom Variables Workshop</h3>
                    <p class="product-description">Learn to create custom JavaScript variables, lookup tables, and RegEx tables in GTM.</p>
                    <div class="product-price">59.99 EUR</div>
                    <button class="btn add-to-basket-btn">Add to Basket</button>
                </div>

                <!-- Product 6 -->
                <div class="product-card"
                    data-item-id="SKU-006"
                    data-item-name="Debugging and Testing Guide"
                    data-item-price="29.99">
                    <div class="product-image-placeholder">DBG</div>
                    <h3>Debugging and Testing Guide</h3>
                    <p class="product-description">Use GTM Preview Mode, Tag Assistant, and browser DevTools like a professional.</p>
                    <div class="product-price">29.99 EUR</div>
                    <button class="btn add-to-basket-btn">Add to Basket</button>
                </div>

                <!-- Product 7 -->
                <div class="product-card"
                    data-item-id="SKU-007"
                    data-item-name="Server-Side GTM Setup"
                    data-item-price="119.99">
                    <div class="product-image-placeholder">SST</div>
                    <h3>Server-Side GTM Setup</h3>
                    <p class="product-description">Deploy server-side tagging with Google Tag Manager for improved data quality and privacy.</p>
                    <div class="product-price">119.99 EUR</div>
                    <button class="btn add-to-basket-btn">Add to Basket</button>
                </div>

                <!-- Product 8 -->
                <div class="product-card"
                    data-item-id="SKU-008"
                    data-item-name="Google Ads Conversion Tracking"
                    data-item-price="69.99">
                    <div class="product-image-placeholder">ADS</div>
                    <h3>Google Ads Conversion Tracking</h3>
                    <p class="product-description">Set up Google Ads conversion tracking, remarketing tags, and enhanced conversions via GTM.</p>
                    <div class="product-price">69.99 EUR</div>
                    <button class="btn add-to-basket-btn">Add to Basket</button>
                </div>

            </div>

            <section class="card mt-2">
                <h2>Why This Page Matters for GTM Learning</h2>
                <p>
                    Product pages are perfect for learning GTM because they have rich user
                    interactions we want to track:
                </p>
                <ul>
                    <li><strong>Button Clicks:</strong> Track "Add to Basket" interactions via the <code>add_to_cart</code> dataLayer event</li>
                    <li><strong>Product Data:</strong> Capture product name, ID, and price using <code>data-*</code> attributes</li>
                    <li><strong>E-commerce Events:</strong> Follow the GA4 ecommerce schema for add-to-cart events</li>
                    <li><strong>Ecommerce Funnel:</strong> This page is step 1 of the funnel: Browse &rarr; Add to Cart &rarr; Checkout &rarr; Purchase</li>
                </ul>
                <p>
                    Open the <strong>GTM Debug</strong> panel (bottom-right) and click an "Add to Basket" button.
                    You will see the <code>add_to_cart</code> event appear in the dataLayer log with the
                    full ecommerce payload.
                </p>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <ul class="footer-links">
                <li><a href="privacy.html">Privacy Policy</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="https://github.com/PokojniFranja/wot-is-gtm" target="_blank">GitHub</a></li>
            </ul>
            <p>&copy; 2026 GTM Learning Project. Built for educational purposes.</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <!-- Load order is important:
         1. dataLayer.js - Initialize dataLayer array
         2. consent.js - Handle consent banner and user choices
         3. debug.js - Debug dashboard for learning
         4. basket.js - Basket state management and ecommerce dataLayer events
         5. main.js - General site functionality (notifications, nav highlighting) -->
    <script src="js/dataLayer.js"></script>
    <script src="js/consent.js"></script>
    <script src="js/debug.js"></script>
    <script src="js/basket.js"></script>
    <script src="js/main.js"></script>

    <!-- Products Page Specific JavaScript -->
    <script src="js/products.js"></script>
</body>

</html>
